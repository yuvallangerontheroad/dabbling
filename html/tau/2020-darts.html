<!doctype html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Tau Day 2020</title>
		<style tyle="text/css">
canvas {
	border: 5px dotted red;
}
		</style>
		<script type="text/javascript">
'use strict';

(
	function() {
		let points = [];
		function lerp(from, to, t) {
			return to * t + from * (1 - t);
		}
		function unit_coordinate_to_canvas_coordinate(unit_x, canvas_length, margin) {
			return lerp(canvas_length * margin, canvas_length * (1 - margin), (unit_x + 1)/2);
		}
		function main() {
			let canvas = document.querySelector('#canvas');
			let c = canvas.getContext('2d');
			c.fillStyle = 'white';
			c.fillRect(0, 0, canvas.width, canvas.height);
			let margin = 0.1;

			c.beginPath();
			c.arc(canvas.width / 2, canvas.height / 2, 0.5 * canvas.width - margin * canvas.width, 0, 2 * Math.PI, false);
			c.stroke();
			let number_of_points = 0;
			let number_of_points_inside = 0;
			points.push(lerp(-1, 1, Math.random()));
			points.push(lerp(-1, 1, Math.random()));
			for (let i = 0; i < points.length - 2; i+=2) {
				let unit_x = points[i];
				let unit_y = points[i + 1];
				if ((unit_x > 1) || (unit_y > 1) || (unit_x < -1) || (unit_y < -1)) {
					continue;
				}

				let canvas_x = unit_coordinate_to_canvas_coordinate(unit_x, canvas.width, margin);
				let canvas_y = unit_coordinate_to_canvas_coordinate(unit_y, canvas.height, margin);

				number_of_points += 1

				if ((unit_x * unit_x + unit_y * unit_y) < 1) {
					c.fillStyle = 'red';
					number_of_points_inside += 1;
				} else {
					c.fillStyle = 'black';
				};
				c.beginPath();
				c.arc(canvas_x, canvas_y, 1, 0, 2 * Math.PI, false);
				c.fill();
			};

			c.fillStyle = 'blue';
			c.font = '10px serif';
			let tau_approximation = 8 * number_of_points_inside / number_of_points;
			c.fillText(`τ: ${Math.floor(tau_approximation * 100) / 100}  = (8 * ${number_of_points_inside} / ${number_of_points}) error: ${Math.abs(Math.PI * 2 - tau_approximation)}`, 10, 10);
			if (Math.abs(2 * Math.PI - tau_approximation) < 0.001) {
				c.font = '40px serif';
				c.fillText('HAPPY τ DAY!', 20, 50);
				return;
			}
			window.requestAnimationFrame(main);
		};

		window.addEventListener('load', main);
	}
)();
		</script>
	</head>
	<body>
		<canvas id="canvas" width="500" height="500"></canvas>
	</body>
</html>
